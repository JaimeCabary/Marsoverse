<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MarsOverse Blackjack</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="screens\blacko.png" type="image/x-icon" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Orbitron', sans-serif;
      background: url('black.png') center center / cover no-repeat fixed;
      color: #fff;
    }

    section {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      box-sizing: border-box;
      padding: 20px;
      overflow: auto;
    }

    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
       background: linear-gradient(to bottom, rgba(0,0,0,0.85), rgba(0,0,0,0.95));/* You can go higher: 0.85 for darker */
  z-index: -1;
      pointer-events: none;
    }

    #rules-slide {
      position: relative;
      z-index: 10;
      background: rgba(0, 0, 0, 0.6);
      padding: 50px 20px;
      text-align: center;
      color: #ffd6b8;
    }

    #slide-box {
      background: rgba(24, 8, 2, 0.75);
      border: 1px solid #ff6600;
      border-radius: 12px;
      padding: 30px 25px;
      max-width: 650px;
      width: 100%;
      box-shadow: 0 0 18px #ff440088;
      backdrop-filter: blur(3px);
    }

    #slide-title {
      color: #FFA94A;
      font-size: 1.8rem;
      margin-bottom: 20px;
    }

    #slide-text {
      font-size: 1.1rem;
      line-height: 1.8;
      color: #ffdbb2;
      margin-bottom: 25px;
    }

    .slide-actions {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
    }

    .slide-actions button {
      background-color: #FF4B00;
      color: white;
      border: none;
      padding: 12px 22px;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 0 12px #FF4B00bb;
    }

    .slide-actions button:hover {
      background-color: #FF6B20;
    }

    #game {
      display: none;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      z-index: 10;
      min-height: 100vh;
    }

    h1 {
      margin-bottom: 10px;
    }

    #dealer-area, #player-area {
      text-align: center;
      margin: 10px 0;
    }

    .cards {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .card {
      width: 80px;
      height: 120px;
      background-size: cover;
      border-radius: 8px;
    }

    #controls {
      display: flex;
      gap: 15px;
      margin: 20px 0;
    }

    button {
      padding: 10px 18px;
      font-size: 1rem;
      /* background-color: #FF4B00; */
      background: linear-gradient(45deg, #FF6200, #ff9d00 25%, #d0ff00 75%);
      border: none;
      font-weight: bolder;
      border-radius: 6px;
      /* color: white;
       */color: rgb(26, 6, 0);
      cursor: pointer;
    }
    #next-btn{
      padding: 10px 18px;
      font-size: 1rem;
      font-weight: bolder;
      background: linear-gradient(45deg, #FF6200, #FFD700 25%, #00A3FF 75%);
      border: none;
      border-radius: 6px;
      color: rgb(26, 6, 0);
      cursor: pointer;
    }
    #next-btn:hover{
      /* background: linear-gradient(45deg, #7e3000, #5b6f01 25%, #5b6f01 25%, #01446b 75%); */
    opacity: 0.8;
    /* text-decoration: underline; */
    }
    button:hover{
      /* background: linear-gradient(45deg, #7e3000, #5b6f01 25%, #5b6f01 25%, #01446b 75%); */
    opacity: 0.8;
    color: rgb(65, 15, 0);
    /* text-decoration: underline; */
  }


    #status {
      font-size: 1.2rem;
      margin-top: 10px;
    }

    #balance {
      font-size: 1.1rem;
      margin-top: 5px;
    }
    .back-btn {
  color: #ffcc99;
  text-decoration: none;
  font-size: 0.95rem;
  text-shadow: 0 0 3px #ff7f50;
}

    #resultModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    #resultBox {
      background: rgba(24, 8, 2, 0.8);
      border: 1px solid #ff6600;
      border-radius: 12px;
      padding: 30px 25px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 0 20px #ff5500aa;
      backdrop-filter: blur(4px);
      color: #ffdbb2;
      font-family: 'Orbitron', sans-serif;
    }
    .back-home {
      font-weight: bold;
      font-size: 1.2rem;
      background: linear-gradient(45deg, #FF6200, #FFD700 25%, #00A3FF 50%, #FFFFFF 75%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text; /* for Firefox */
      color: transparent;
      text-decoration: none;
    }
      .back-home:hover {
    opacity: 0.8;
    /* text-decoration: underline; */
  }

  </style>
</head>
<body>
  <div id="overlay"></div>

  <section id="rules-slide">
    <div id="slide-box">
      <h2 id="slide-title">ü™ê Welcome to MarsOverse Blackjack</h2>
      <p id="slide-text">
        Welcome, Commander. In MarsOverse, Blackjack isn‚Äôt just a game ‚Äî it‚Äôs a battle of wits.<br><br>
        Your goal? Get as close to <strong>21</strong> without going over... and beat the dealer.
      </p>
      <div class="slide-actions">
        <button id="next-btn" onclick="nextSlide()">Next</button>
        <a href="#" class="back-home" onclick="showGame(); return false;">‚û± Skip Rules</a>
      </div>
    </div>
  </section>

  <section id="game">
    <h1>ü™ê MarsOverse Blackjack</h1>
    <div id="balance">XP: 0 | Balance: 0.00 USDT</div>
    <div id="dealer-area">
      <h2>Dealer</h2>
      <div id="dealer-cards" class="cards"></div>
    </div>
    <div id="player-area">
      <h2>You</h2>
      <div id="player-cards" class="cards"></div>
    </div>
    <div id="controls">
      <button onclick="startGame()">Start Game</button>
      <button onclick="hit()">Hit</button>
      <button onclick="stand()">Stand</button>
    </div>
    <div id="status"></div>
    <a href="/marzo.html" class="back-home">‚á¶ Return to Mars</a>
  </section>

  <div id="resultModal" style="display: none;">
    <div id="resultBox">
      <h2 id="resultTitle">Result</h2>
      <p id="resultMessage">You win!</p>
      <button onclick="closeResult()">OK</button>
    </div>
  </div>
    <!-- üéµ Full Sound Stack -->
  <audio id="introSound" src="/sounds/intro.mp3" preload="auto" loop></audio>
  <audio id="marsostory" src="/sounds/marsostory.mp3" preload="auto" loop></audio>
  <audio id="afterstorySound" src="/sounds/afterstory.mp3" preload="auto"></audio>
  <audio id="clickSound" src="/sounds/click.mp3" preload="auto"></audio>
  <audio id="sparkleSound" src="/sounds/sparkle.mp3" preload="auto"></audio>
  <audio id="levelupSound" src="/sounds/levelup.mp3" preload="auto"></audio>
  <audio id="xpSound" src="/sounds/xp.mp3" preload="auto"></audio>
  <audio id="popSound" src="/sounds/pop.mp3" preload="auto"></audio>
  <audio id="bondSound" src="/sounds/bond.mp3" preload="auto"></audio>
  <audio id="birthSound" src="/sounds/birthsound.mp3" preload="auto"></audio>
  <audio id="explosionSound" src="/sounds/explosion.mp3" preload="auto"></audio>
  <audio id="riserSound" src="/sounds/riser-hit-sfx-001-289802.mp3" preload="auto"></audio>
  <audio id="swooshSound" src="/sounds/swoosh-sound-effect-for-fight-scenes-or-transitions-2-149890.mp3" preload="auto"></audio>
  <audio id="typingSound" src="/sounds/typing.mp3" preload="auto"></audio>
  <audio id="galaxySound" src="/sounds/galaxy.mp3" preload="auto"></audio>
  <audio id="astroSound" src="/sounds/asteroid.mp3" preload="auto"></audio>
  <!-- üé∂ Newly Added Sounds -->
  <audio id="babyLaughSound" src="/sounds/babylaugh.mp3" preload="auto"></audio>
  <audio id="babyTalkSound" src="/sounds/babytalk.mp3" preload="auto"></audio>
  <audio id="cryingBabySound" src="/sounds/crying-baby-320170.mp3" preload="auto"></audio>
  <audio id="casinoSound" src="/sounds/casino.wav" preload="auto"></audio>
  <audio id="gameUnlockSound" src="/sounds/gameunlock.wav" preload="auto"></audio>
  <audio id="healthHighSound" src="/sounds/healthhi.wav" preload="auto"></audio>
  <audio id="historySound" src="/sounds/history.wav" preload="auto"></audio>
  <audio id="levelCompSound" src="/sounds/levelcomp.wav" preload="auto"></audio>
  <audio id="levelerSound" src="/sounds/leveler.wav" preload="auto"></audio>
  <audio id="marsThemeSound" src="/sounds/mars_theme.mp3" preload="auto" loop></audio>
  <audio id="arcadeRisingSound" src="/sounds/mixkit-arcade-rising-231.wav" preload="auto"></audio>
  <audio id="arcadeAlertSound" src="/sounds/mixkit-arcade-video-game-machine-alert-2821.wav" preload="auto"></audio>
  <audio id="xpIncreasedSound" src="/sounds/mixkit-game-experience-level-increased-2062.wav" preload="auto"></audio>
  <audio id="pokerSound" src="/sounds/poker.wav" preload="auto"></audio>
  <audio id="scifiSound" src="/sounds/scifi.wav" preload="auto"></audio>
  <audio id="treasureSound" src="/sounds/treasure.wav" preload="auto"></audio>
  <audio id="winSound" src="/sounds/win.wav" preload="auto"></audio>
  <!-- üéµ Game Sound Stack -->
<audio id="ash" src="/sounds/ash.mp3" preload="auto" loop></audio>
<audio id="beat" src="/sounds/beat.mp3" preload="auto" loop></audio>
<audio id="faith" src="/sounds/faith.mp3" preload="auto" loop></audio>
<audio id="gameboy" src="/sounds/gameboy.mp3" preload="auto" loop></audio>
<audio id="lose" src="/sounds/lose.mp3" preload="auto"></audio> <!-- Not looping -->
<audio id="mainsound" src="/sounds/mainsound.mp3" preload="auto" loop></audio>
<audio id="moi" src="/sounds/moi.mp3" preload="auto"></audio> <!-- Not looping -->
<audio id="there" src="/sounds/there.mp3" preload="auto" loop></audio>
<audio id="word" src="/sounds/word.mp3" preload="auto" loop></audio>

    <script>
    function play(id) {
  const audio = document.getElementById(id);
  if (audio) {
    audio.currentTime = 0; // rewind to start
    audio.play().catch(err => console.log("Play error:", err));
  } else {
    console.warn(`Audio with id "${id}" not found`);
  }
}

    //   // document.getElementById("introSound").loop = true;
    //   document.getElementById("introSound").currentTime = 0;
    //   document.getElementById("introSound").play().catch(() => {});
     const slides = [
      {
        title: "ü™ê Welcome to MarsOverse Blackjack",
        text: `Welcome, Commander. In MarsOverse, Blackjack isn‚Äôt just a game ‚Äî it‚Äôs a battle of wits.<br><br>Your goal? Get as close to <strong>21</strong> without going over... and beat the dealer.`
      },
      {
        title: "üé¥ Understand the Cards",
        text: `Each player (you and the dealer) is dealt <strong>2 cards</strong>.<br><br>‚Ä¢ Number cards = face value<br>‚Ä¢ Face cards (J, Q, K) = <strong>10</strong><br>‚Ä¢ Ace = <strong>1 or 11</strong>`
      },
      {
        title: "üéÆ How to Play",
        text: `Tap <strong>\"Hit\"</strong> to draw another card.<br>Tap <strong>\"Stand\"</strong> when you're done.<br><br>The dealer draws until they reach 17.`
      },
      {
        title: "üèÜ Rewards on Mars",
        text: `‚Ä¢ Win = +10 XP & 0.01 USDT<br>‚Ä¢ Draw = 0 XP<br>‚Ä¢ Lose = nothing üòû` }
    ];

    let currentSlide = 0;
    function nextSlide() {
      currentSlide++;
      if (currentSlide < slides.length) {
        document.getElementById("slide-title").innerHTML = slides[currentSlide].title;
        document.getElementById("slide-text").innerHTML = slides[currentSlide].text;
        if (currentSlide === slides.length - 1) {
          document.getElementById("next-btn").textContent = "üéÆ Play Now";
          document.getElementById("next-btn").onclick = () => showGame();
        }
      }
    }

    function showGame() {
      document.getElementById("rules-slide").style.display = "none";
      document.getElementById("game").style.display = "flex";
    }

    const deck = [], suits = ['S','H','D','C'], ranks = ['A','2','3','4','5','6','7','8','9','0','J','Q','K'];
    let playerHand = [], dealerHand = [], xp = 0, balance = 0.00;
    const betAmount = 0.01;

    function getCardImage(code) {
      return `https://deckofcardsapi.com/static/img/${code}.png`;
    }

    function shuffleDeck() {
      deck.length = 0;
      for (let suit of suits) for (let rank of ranks) deck.push(rank + suit);
      for (let i = deck.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
    }

    function dealCard(hand, containerId) {
      // document.getElementById("clickSound").play();
      const card = deck.pop();
      hand.push(card);
      const img = document.createElement("img");
      img.src = getCardImage(card);
      img.className = "card";
      document.getElementById(containerId).appendChild(img);
    }

    function handValue(hand) {
      let sum = 0, aces = 0;
      for (let card of hand) {
        let rank = card[0];
        if (rank === 'A') { sum += 11; aces++; }
        else if (['K','Q','J','0'].includes(rank)) sum += 10;
        else sum += parseInt(rank);
      }
      while (sum > 21 && aces > 0) { sum -= 10; aces--; }
      return sum;
    }

    // function startGame() {
    //   shuffleDeck();
    //   playerHand = [], dealerHand = [];
    //   document.getElementById("dealer-cards").innerHTML = "";
    //   document.getElementById("player-cards").innerHTML = "";
    //   document.getElementById("status").textContent = "";
    //   dealCard(playerHand, "player-cards");
    //   dealCard(dealerHand, "dealer-cards");
    //   dealCard(playerHand, "player-cards");
    //   dealCard(dealerHand, "dealer-cards");
    //   updateStatus();
    // }
      function startGame() {
    // Reset hands and deck
    shuffleDeck();
    playerHand = [];
    dealerHand = [];

    // Reset XP and balance display
    xp = 0;
    balance = 0;

    // Reset display elements
    document.getElementById("dealer-cards").innerHTML = "";
    document.getElementById("player-cards").innerHTML = "";
    document.getElementById("status").textContent = "";
    document.getElementById("balance").textContent = "XP: 0 | Balance: 0.00 USDT";

    // Deal cards
    dealCard(playerHand, "player-cards");
    dealCard(dealerHand, "dealer-cards");
    dealCard(playerHand, "player-cards");
    dealCard(dealerHand, "dealer-cards");

    // Reset start button text (optional, just to be neat)
    const startBtn = document.querySelector("#controls button:first-child");
    startBtn.textContent = "Start Game";

    updateStatus();
  }


    function hit() {
      if (playerHand.length === 0) return;
      dealCard(playerHand, "player-cards");
      const val = handValue(playerHand);
      if (val > 21) {
      endGame("Bust! You lose.");
      play("lose");
    } else {
      updateStatus();
    }

    }

    function stand() {
      if (playerHand.length === 0) return;
      while (handValue(dealerHand) < 17) dealCard(dealerHand, "dealer-cards");
      const playerVal = handValue(playerHand);
      const dealerVal = handValue(dealerHand);
      if (dealerVal > 21 || playerVal > dealerVal) {
        // play("levelCompSound")
        // document.getElementById("levelupSound").play();
        xp += 5;
        balance += betAmount;
        
        endGame(`You win! üèÜ +5 XP +$${betAmount.toFixed(2)} USDT`);
        play("levelCompSound")
      }  else if (playerVal === dealerVal) {
        endGame("It's a draw!");
        play("moi");
      } else {
        endGame("Dealer wins. üòû");
        play("lose");
      }
    }

    function endGame(message) {
      document.getElementById("status").textContent = message;
      updateBalance();
      xp = 0;
      balance = 0;

      // Change button text to "Play Again"
      const startBtn = document.querySelector("#controls button:first-child");
      startBtn.textContent = "Play Again";
      showResultDialog(message);
    }

    function updateStatus() {
      const val = handValue(playerHand);
      document.getElementById("status").textContent = `Your Hand: ${val}`;
    }

    // function updateBalance() {
    //   document.getElementById("balance").textContent = `XP: ${xp} | Balance: ${balance.toFixed(2)} USDT`;
    // }

    function updateBalance() {
    // Update display of the game-specific balance
    document.getElementById("balance").textContent = `XP: ${xp} | Balance: ${balance.toFixed(2)} USDT`;

    // Get existing wallet and XP from localStorage
    let walletBalance = parseFloat(localStorage.getItem("walletBalance")) || 0;
    let playerXP = parseInt(localStorage.getItem("playerXP")) || 0;

    // Add the current game values to the stored wallet
    walletBalance += balance;
    playerXP += xp;

    // Save the new totals
    localStorage.setItem("walletBalance", walletBalance.toFixed(2));
    localStorage.setItem("playerXP", playerXP);
  }

    function showResultDialog(message) {
      document.getElementById("resultMessage").innerHTML = message;
      document.getElementById("resultModal").style.display = "flex";
    }

    function closeResult() {
      document.getElementById("resultModal").style.display = "none";
    }


  // document.addEventListener('click', (event) => {
  //   const excludedTags = ['AUDIO', 'VIDEO', 'INPUT', 'TEXTAREA', 'BUTTON'];
  //   if (excludedTags.includes(event.target.tagName)) return;

  //   const clickSound = document.getElementById('clickSound');
  //   if (clickSound) {
  //     clickSound.currentTime = 0;
  //     clickSound.play();
  //   }
  // });

  </script>
  <script>
  const sounds = {
    click: document.getElementById('clickSound'),
    win: document.getElementById('winSound'),
    lose: document.getElementById('loseSound'),
  };

  // Helper to play sound safely
  function playSound(soundName) {
    const sound = sounds[soundName];
    if (sound) {
      sound.currentTime = 0;
      sound.play().catch(() => {});
    }
  }

document.addEventListener('click', (event) => {
  const soundControl = document.getElementById('sound-control');
  const clickSound = document.getElementById('clickSound');

  if (soundControl && soundControl.contains(event.target)) {
    // Don't play sound if clicking inside the sound-control
    return;
  }

  if (clickSound) {
    clickSound.currentTime = 0;
    clickSound.play().catch(() => {});
  }
});


</script>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    const allSounds = document.querySelectorAll("audio");
    const volumeSlider = document.querySelector(".slider .level");

    // Set initial volume from localStorage or default to 1
    const initialVolume = parseFloat(localStorage.getItem("marsVolume")) || 1;
    if (volumeSlider) volumeSlider.value = initialVolume;
    allSounds.forEach(sound => sound.volume = initialVolume);

    // Volume change handler
    if (volumeSlider) {
      volumeSlider.addEventListener("input", function () {
        const vol = parseFloat(this.value);
        allSounds.forEach(sound => sound.volume = vol);
        localStorage.setItem("marsVolume", vol);
      });
    }
const afterstory = document.getElementById("afterstorySound");
const mainsound= document.getElementById("mainsound");

if (afterstory) {
  afterstory.currentTime = 0;
  afterstory.loop = false; // play once
  afterstory.volume = initialVolume;

  afterstory.play().catch(err => console.warn("Afterstory play error:", err));

  setTimeout(() => {
    afterstory.pause();
    afterstory.currentTime = 0;mainsound

    if (mainsound) {
      mainsound.currentTime = 0;
      mainsound.loop = true;
      mainsound.volume = initialVolume;
      mainsound.play().catch(err => console.warn("gameboy play error:", err));
    }
  }, 7000); // Stop after 4 seconds
}

  });
</script>

<!-- <script>
  window.addEventListener("DOMContentLoaded", () => {
    const allSounds = document.querySelectorAll("audio");
    const volumeSlider = document.querySelector(".slider .level");

    if (!volumeSlider) {
      console.warn("Volume slider not found.");
      return;
    }

    // Set initial volume from localStorage or default to 1
    const initialVolume = parseFloat(localStorage.getItem("marsVolume")) || 1;
    volumeSlider.value = initialVolume;
    allSounds.forEach(sound => sound.volume = initialVolume);

    // Update volume live and persist
    volumeSlider.addEventListener("input", function () {
      const vol = parseFloat(this.value);
      allSounds.forEach(sound => sound.volume = vol);
      localStorage.setItem("marsVolume", vol);
    });
    // // üîä Start ambient loop sound (afterstorySound)
    // const ambient = document.getElementById("afterstorySound");
    // if (ambient) {
    //   ambient.currentTime = 0;
    //   ambient.loop = true;
    //   ambient.volume = initialVolume;
    //   ambient.play().catch(() => {});
    // }
    const intro = document.getElementById("afterstory");
    intro.play();
    intro.addEventListener("ended", () => {
      // When intro ends, start marsostory
      const story = document.getElementById("marsostory");
      story.play();
    });
  });
</script> -->


  <div id="sound-control" style="position: fixed; bottom: 20px; left: 27px; z-index: 9999; width: 25px;">
  <label class="slider">
    <input type="range" class="level" min="0" max="1" step="0.01" value="1" />
    <svg class="volume" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" >
      <g>
        <path d="M18.36 19.36a1 1 0 0 1-.705-1.71C19.167 16.148 20 14.142 20 12s-.833-4.148-2.345-5.65a1 1 0 1 1 1.41-1.419C20.958 6.812 22 9.322 22 12s-1.042 5.188-2.935 7.069a.997.997 0 0 1-.705.291z" fill="currentColor"></path>
        <path d="M15.53 16.53a.999.999 0 0 1-.703-1.711C15.572 14.082 16 13.054 16 12s-.428-2.082-1.173-2.819a1 1 0 1 1 1.406-1.422A6 6 0 0 1 18 12a6 6 0 0 1-1.767 4.241.996.996 0 0 1-.703.289zM12 22a1 1 0 0 1-.707-.293L6.586 17H4c-1.103 0-2-.897-2-2V9c0-1.103.897-2 2-2h2.586l4.707-4.707A.998.998 0 0 1 13 3v18a1 1 0 0 1-1 1z" fill="currentColor"></path>
      </g>
    </svg>
  </label>
</div>
</body>
</html>
