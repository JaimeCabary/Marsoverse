<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Mars Poker ‚ô†Ô∏è</title>
  <link rel="icon" href="screens/poke.png" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
  <style>
      body {
  margin: 0;
  padding: 0;
  font-family: 'Orbitron', sans-serif;
  background-image: url('pokertable.png');
  background-position: center center;
  background-repeat: no-repeat;
  background-size: 100% 100%;
  background-attachment: fixed;
  color: #fff;
}
/* html, body {
  height: 100%;
  overflow: hidden; /* prevent scroll on all platforms */
/* }  */



section {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  padding: 20px;
  overflow: auto; /* important for mobile and long content */
}

    #game {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  box-sizing: border-box;
  min-height: 100vh;
}
    h1 {
      margin-bottom: 10px;
      color: #FFF4F0;
      font-size: 2rem;
      text-shadow: 0 0 10px #000000AA;
    }

    #dealer-area, #player-area, #table-area {
      text-align: center;
      margin: 10px 0;
    }

    .cards {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .card {
      width: 90px;
      height: 125px;
      background-size: cover;
      border-radius: 8px;
    }

    #controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin: 20px 0;
      justify-content: center;
    }

    button {
      padding: 10px 18px;
      font-size: 1rem;
      background-color: #FF4B00;
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      box-shadow: 0 0 8px #FF4B00aa;
    }

    #status {
      font-size: 1.1rem;
      margin-top: 10px;
      color: #ffd;
      text-shadow: 0 0 4px #ffa;
    }

    #balance {
      font-size: 1rem;
      margin-top: 5px;
    }

    a.back-home {
      color: #ffb;
      text-decoration: none;
      font-size: 0.9rem;
      margin-top: 10px;
    }
    #overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.75); /* You can go higher: 0.85 for darker */
  z-index: 0;
  pointer-events: none;
}
#rules-scroll {
  position: relative;
  z-index: 10; /* Make it higher than overlay */
  background: url('mars-scroll-bg.png') no-repeat center center;
  background-size: cover;
  background-color: #150505;
  padding: 50px 20px 30px;
  text-align: center;
  color: #ffd6b8;
  font-family: 'Orbitron', sans-serif;
  box-shadow: inset 0 0 20px #FF4B00aa;
}
.scroll-container {
  max-width: 680px;
  margin: auto;
  background: rgba(24, 8, 2, 0.75);
  border: 1px solid #ff6600;
  border-radius: 12px;
  padding: 25px 20px;
  box-shadow: 0 0 18px #ff440088, 0 0 12px #ff660044 inset;
  backdrop-filter: blur(3px);
}

#rules-scroll h2 {
  font-size: 1.7rem;
  margin-bottom: 16px;
  color: #FFA94A;
  text-shadow: 0 0 4px #FF7F50, 0 0 10px #ff6600aa;
}

#rules-scroll p {
  font-size: 1rem;
  line-height: 1.8;
  color: #ffdbb2;
  text-shadow: 0 0 6px #441a00;
}

.scroll-actions {
  margin-top: 20px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
}

.scroll-actions button {
  background-color: #FF4B00;
  color: white;
  border: none;
  padding: 10px 20px;
  font-size: 1rem;
  border-radius: 6px;
  cursor: pointer;
  box-shadow: 0 0 12px #FF4B00bb;
  transition: background 0.3s ease;
}

.scroll-actions button:hover {
  background-color: #FF6B20;
}

.back-btn {
  color: #ffcc99;
  text-decoration: none;
  font-size: 0.95rem;
  text-shadow: 0 0 3px #ff7f50;
}
#rules-slide {
  position: relative;
  z-index: 15;
  background: rgba(1, 0, 0, 0.391); /* semi-transparent black over pokertable */
color: #ffd6b8;
  padding: 40px 20px;
  font-family: 'Orbitron', sans-serif;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

#slide-box {
  background: rgba(24, 8, 2, 0.54);
  border: 1px solid #ff6600;
  border-radius: 12px;
  padding: 30px 25px;
  max-width: 650px;
  width: 100%;
  text-align: center;
  box-shadow: 0 0 20px #ff5500aa;
  backdrop-filter: blur(4px);
}

#slide-title {
  color: #FFA94A;
  font-size: 1.8rem;
  margin-bottom: 20px;
}

#slide-text {
  font-size: 1.1rem;
  line-height: 1.8;
  color: #ffdbb2;
  margin-bottom: 25px;
}

.slide-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
}

.slide-actions button {
  background-color: #FF4B00;
  color: white;
  border: none;
  padding: 12px 22px;
  font-size: 1rem;
  border-radius: 6px;
  cursor: pointer;
  box-shadow: 0 0 12px #FF4B00bb;
}

.slide-actions button:hover {
  background-color: #FF6B20;
}
#overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85); /* Darker overlay */
  z-index: 0;
  pointer-events: none;
}


.back-btn {
  color: #ffcc99;
  text-decoration: none;
  font-size: 0.95rem;
  text-shadow: 0 0 3px #ff7f50;
}
#resultModal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(rgba(0, 0, 0, 0.85), rgba(15, 5, 5, 0.95));
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 999;
}

#resultBox {
  background: rgba(24, 8, 2, 0.8);
  border: 1px solid #ff6600;
  border-radius: 12px;
  padding: 30px 25px;
  max-width: 400px;
  width: 90%;
  text-align: center;
  box-shadow: 0 0 20px #ff5500aa;
  backdrop-filter: blur(4px);
  color: #ffdbb2;
  font-family: 'Orbitron', sans-serif;
}

#resultBox h2 {
  color: #FFA94A;
  margin-bottom: 15px;
}

#resultBox p {
  font-size: 1.1rem;
  line-height: 1.6;
  margin-bottom: 20px;
}

#resultBox button {
  background-color: #FF4B00;
  color: white;
  border: none;
  padding: 12px 24px;
  font-size: 1rem;
  border-radius: 6px;
  cursor: pointer;
  box-shadow: 0 0 12px #FF4B00bb;
}

#resultBox button:hover {
  background-color: #FF6B20;
}

  </style>
</head>
<body>
  <div id="overlay"></div> <!-- Keep it here -->
<section id="rules-slide" class="slide-container">
  
  <div id="slide-box">
    <h2 id="slide-title">üìú Welcome to Mars Poker</h2>
    <p id="slide-text">
      You‚Äôve landed on a hostile world, but one tradition keeps everyone sharp: <strong>Mars Poker</strong>.<br><br>
      It‚Äôs you vs Cubeco ‚Äî and every card you play earns you power on Mars.
    </p>
    <div class="slide-actions">
      <button id="next-btn" onclick="nextSlide()">Next</button>
      <a href="#" class="back-btn" onclick="showGame(); return false;">‚Üê Skip Rules</a>
    </div>
  </div>
</section>
 <section id="game" style="display: none;">
    <h1>ü™êMarsoverse Poker ‚ô†Ô∏è</h1>

   <div id="balance">
  XP: <span id="xpCount">0</span> |
  Wallet: <span id="walletCount">0.00</span> USDT |
  Highest XP: <span id="highXP">0</span>
</div>


    <div id="player-area">
      <h3>Your Hand</h3>
      <div id="playerHand" class="cards"></div>
    </div>

    <div id="table-area">
      <h3>Community Cards</h3>
      <div id="communityCards" class="cards"></div>
    </div>

    <div id="dealer-area">
      <h3>Cubeco's Hand</h3>
      <div id="botHand" class="cards"></div>
    </div>

    <div id="status"></div>

    <div id="controls">
      <button onclick="dealCards()">Deal</button>
      <button onclick="reveal()">Reveal</button>
      <button onclick="restart()">Restart</button>
    </div>

    <a href="/marzo.html" class="back-home">‚Üê Return to Mars</a>
 </section>
 <div id="resultModal" style="display: none;">
  <div id="resultBox">
    <h2 id="resultTitle">Result</h2>
    <p id="resultMessage">You win!</p>
    <button onclick="closeResult()">OK</button>
  </div>
</div>
   <!-- üéµ Full Sound Stack -->
  <audio id="introSound" src="/sounds/intro.mp3" preload="auto" loop></audio>
  <audio id="marsostory" src="/sounds/marsostory.mp3" preload="auto" loop></audio>
  <audio id="afterstorySound" src="/sounds/afterstory.mp3" preload="auto"></audio>
  <audio id="clickSound" src="/sounds/click.mp3" preload="auto"></audio>
  <audio id="sparkleSound" src="/sounds/sparkle.mp3" preload="auto"></audio>
  <audio id="levelupSound" src="/sounds/levelup.mp3" preload="auto"></audio>
  <audio id="xpSound" src="/sounds/xp.mp3" preload="auto"></audio>
  <audio id="popSound" src="/sounds/pop.mp3" preload="auto"></audio>
  <audio id="bondSound" src="/sounds/bond.mp3" preload="auto"></audio>
  <audio id="birthSound" src="/sounds/birthsound.mp3" preload="auto"></audio>
  <audio id="explosionSound" src="/sounds/explosion.mp3" preload="auto"></audio>
  <audio id="riserSound" src="/sounds/riser-hit-sfx-001-289802.mp3" preload="auto"></audio>
  <audio id="swooshSound" src="/sounds/swoosh-sound-effect-for-fight-scenes-or-transitions-2-149890.mp3" preload="auto"></audio>
  <audio id="typingSound" src="/sounds/typing.mp3" preload="auto"></audio>
  <audio id="galaxySound" src="/sounds/galaxy.mp3" preload="auto"></audio>
  <audio id="astroSound" src="/sounds/asteroid.mp3" preload="auto"></audio>
  <!-- üé∂ Newly Added Sounds -->
  <audio id="babyLaughSound" src="/sounds/babylaugh.mp3" preload="auto"></audio>
  <audio id="babyTalkSound" src="/sounds/babytalk.mp3" preload="auto"></audio>
  <audio id="cryingBabySound" src="/sounds/crying-baby-320170.mp3" preload="auto"></audio>
  <audio id="casinoSound" src="/sounds/casino.wav" preload="auto"></audio>
  <audio id="gameUnlockSound" src="/sounds/gameunlock.wav" preload="auto"></audio>
  <audio id="healthHighSound" src="/sounds/healthhi.wav" preload="auto"></audio>
  <audio id="historySound" src="/sounds/history.wav" preload="auto"></audio>
  <audio id="levelCompSound" src="/sounds/levelcomp.wav" preload="auto"></audio>
  <audio id="levelerSound" src="/sounds/leveler.wav" preload="auto"></audio>
  <audio id="marsThemeSound" src="/sounds/mars_theme.mp3" preload="auto" loop></audio>
  <audio id="arcadeRisingSound" src="/sounds/mixkit-arcade-rising-231.wav" preload="auto"></audio>
  <audio id="arcadeAlertSound" src="/sounds/mixkit-arcade-video-game-machine-alert-2821.wav" preload="auto"></audio>
  <audio id="xpIncreasedSound" src="/sounds/mixkit-game-experience-level-increased-2062.wav" preload="auto"></audio>
  <audio id="pokerSound" src="/sounds/poker.wav" preload="auto"></audio>
  <audio id="scifiSound" src="/sounds/scifi.wav" preload="auto"></audio>
  <audio id="treasureSound" src="/sounds/treasure.wav" preload="auto"></audio>
  <audio id="winSound" src="/sounds/win.wav" preload="auto"></audio>
  <!-- üéµ Game Sound Stack -->
<audio id="ash" src="/sounds/ash.mp3" preload="auto" loop></audio>
<audio id="beat" src="/sounds/beat.mp3" preload="auto" loop></audio>
<audio id="faith" src="/sounds/faith.mp3" preload="auto" loop></audio>
<audio id="gameboy" src="/sounds/gameboy.mp3" preload="auto" loop></audio>
<audio id="lose" src="/sounds/lose.mp3" preload="auto"></audio> <!-- Not looping -->
<audio id="mainsound" src="/sounds/mainsound.mp3" preload="auto" loop></audio>
<audio id="moi" src="/sounds/moi.mp3" preload="auto"></audio> <!-- Not looping -->
<audio id="there" src="/sounds/there.mp3" preload="auto" loop></audio>
<audio id="word" src="/sounds/word.mp3" preload="auto" loop></audio>


  <script>
    
    let playerCards = [], botCards = [], communityCards = [];
    let xp = parseInt(localStorage.getItem("marsXP") || 0);
    let usdt = parseFloat(localStorage.getItem("marsUSDT") || 0);
    let deckID = "";
    let highXP = parseInt(localStorage.getItem("marsHighXP") || 0);
document.getElementById("highXP").textContent = highXP;


    document.getElementById("xpCount").textContent = xp;
    document.getElementById("walletCount").textContent = usdt.toFixed(2);

    async function fetchDeck() {
      const res = await fetch("https://deckofcardsapi.com/api/deck/new/shuffle/?deck_count=1");
      const data = await res.json();
      deckID = data.deck_id;
    }

    async function dealCards() {
      if (!deckID) await fetchDeck();
      const draw = await fetch(`https://deckofcardsapi.com/api/deck/${deckID}/draw/?count=7`);
      const data = await draw.json();
      const cards = data.cards;

      playerCards = cards.slice(0, 2);
      botCards = cards.slice(2, 4);
      communityCards = cards.slice(4, 7);

      document.getElementById("playerHand").innerHTML = renderCards(playerCards);
      document.getElementById("botHand").innerHTML = `
        <div class="card" style="background-image: url('https://deckofcardsapi.com/static/img/back.png')"></div>
        <div class="card" style="background-image: url('https://deckofcardsapi.com/static/img/back.png')"></div>
      `;
      document.getElementById("communityCards").innerHTML = renderCards(communityCards);
      document.getElementById("status").textContent = "";
    }
function play(soundId) {
  const audio = document.getElementById(soundId);
  if (audio) {
    audio.currentTime = 0;
    audio.play().catch(() => {});
  }
}


    function renderCards(cards) {
      return cards.map(c => `<div class="card" style="background-image: url('${c.image}')"></div>`).join("");
    }

function reveal() {
  // Show Cubeco's hand
  document.getElementById("botHand").innerHTML = renderCards(botCards);

  // Calculate scores
  const playerScore = score(playerCards.concat(communityCards));
  const botScore = score(botCards.concat(communityCards));

  let resultMessage = "";
  if (playerScore > botScore) {
    xp += 5;
    usdt += 0.01;
    resultMessage = `üéâ You won!<br>Your Score: ${playerScore}<br>Cubeco's Score: ${botScore}<br>+5 XP, +0.01 USDT`;
    play("levelCompSound");
  } else if (playerScore < botScore) {
    resultMessage = `ü§ñ Cubeco won!<br>Your Score: ${playerScore}<br>Cubeco's Score: ${botScore}<br>Try again!`;
    play("lose");
  } else {
    xp += 2;
    resultMessage = `‚öñÔ∏è It's a draw!<br>Your Score: ${playerScore}<br>Cubeco's Score: ${botScore}<br>+2 XP`;
    play("moi");
  }
  // Update high XP if current is greater
  let highXP = parseInt(localStorage.getItem("marsHighXP") || 0);
  if (xp > highXP) {
    highXP = xp;
    localStorage.setItem("marsHighXP", highXP);
  }
  document.getElementById("highXP").textContent = highXP;

  // Update local storage and UI
  localStorage.setItem("playerXP", xp);
  localStorage.setItem("walletBalance", usdt.toFixed(2));
  document.getElementById("xpCount").textContent = xp;
  document.getElementById("walletCount").textContent = usdt.toFixed(2);

  // Show result modal
  showResultDialog(resultMessage);
}

    function score(cards) {
      return cards.reduce((total, c) => {
        let val = c.value;
        if (!isNaN(val)) return total + parseInt(val);
        if (["KING", "QUEEN", "JACK"].includes(val)) return total + 10;
        if (val === "ACE") return total + 11;
        return total;
      }, 0);
    }

function restart() {
  playerCards = [];
  botCards = [];
  communityCards = [];
  document.getElementById("playerHand").innerHTML = "";
  document.getElementById("botHand").innerHTML = "";
  document.getElementById("communityCards").innerHTML = "";
  document.getElementById("status").textContent = "";

  // Reset XP and wallet **visually** but not in storage
  xp = 0;
  usdt = 0;
  document.getElementById("xpCount").textContent = "0";
  document.getElementById("walletCount").textContent = "0.00";
}

  </script>
  <script>
  const slides = [
    {
      title: "üìú Welcome to Mars Poker",
      text: `You‚Äôve landed on a hostile world, but one tradition keeps everyone sharp: <strong>Mars Poker</strong>.<br><br>
      It‚Äôs you vs Cubeco ‚Äî and every card you play earns you power on Mars.`
    },
    {
      title: "üé¥ Understand the Cards",
      text: `Each player is dealt <strong>2 cards</strong>.<br>The table shows <strong>3 shared cards</strong>.<br><br>
      Card values:<br>
      ‚Ä¢ Number cards = face value<br>
      ‚Ä¢ Face cards (J, Q, K) = <strong>10</strong><br>
      ‚Ä¢ Ace = <strong>11</strong>`
    },
    {
      title: "üéÆ How to Play",
      text: `Step 1: Tap <strong>"Deal"</strong><br>
      ‚Üí You and Cubeco get 2 cards<br>
      ‚Üí 3 community cards appear<br><br>
      Step 2: Tap <strong>"Reveal"</strong><br>
      ‚Üí See Cubeco's hand<br>
      ‚Üí Highest total score wins!`
    },
    {
      title: "üèÜ Win or Lose?",
      text: `‚Ä¢ <strong>You win</strong> ‚Üí +5 XP & 0.01 USDT<br>
      ‚Ä¢ <strong>Draw</strong> ‚Üí +2 XP<br>
      ‚Ä¢ <strong>You lose</strong> ‚Üí No rewards<br><br>
      Every win pushes your journey across Mars üåå`
    },
    {
      title: "üöÄ Ready to Play?",
      text: `Think fast. Tap smart.<br>
      One round can change your mission.<br><br>
      ü™ê Good luck, Commander.`
    }
  ];

  let currentSlide = 0;

  function nextSlide() {
    currentSlide++;
    if (currentSlide < slides.length) {
      document.getElementById("slide-title").innerHTML = slides[currentSlide].title;
      document.getElementById("slide-text").innerHTML = slides[currentSlide].text;
      if (currentSlide === slides.length - 1) {
        document.querySelector(".slide-actions button").innerHTML = "üéÆ Play Now";
        document.querySelector(".slide-actions button").onclick = () => {
          document.querySelector(".slide-actions button").onclick = () => {
  showGame();
};

        };
      }
    }
  }
  function showGame() {
  document.getElementById("rules-slide").style.display = "none";
  document.getElementById("game").style.display = "flex";
  document.getElementById("game").scrollIntoView({ behavior: "smooth" });
}

</script>
<script>
  function showResultDialog(message) {
  document.getElementById("resultMessage").innerHTML = message;
  document.getElementById("resultModal").style.display = "flex";
}

function closeResult() {
  document.getElementById("resultModal").style.display = "none";
}
        // üß† Grab all audio elements
    const allSounds = document.querySelectorAll("audio");
    const volumeSlider = document.querySelector(".slider .level");

    // üéö Set initial volume
    volumeSlider.value = 1;
    allSounds.forEach(sound => sound.volume = volumeSlider.value);

    // üéß Live volume control
    volumeSlider.addEventListener("input", function () {
      const vol = parseFloat(this.value);
      allSounds.forEach(sound => {
        sound.volume = vol;
      });
    });
</script>
<script>
  const sounds = {
    click: document.getElementById('clickSound'),
    win: document.getElementById('winSound'),
    lose: document.getElementById('loseSound'),
  };

  // Helper to play sound safely
  function playSound(soundName) {
    const sound = sounds[soundName];
    if (sound) {
      sound.currentTime = 0;
      sound.play().catch(() => {});
    }
  }

document.addEventListener('click', (event) => {
  const soundControl = document.getElementById('sound-control');
  const clickSound = document.getElementById('clickSound');

  if (soundControl && soundControl.contains(event.target)) {
    // Don't play sound if clicking inside the sound-control
    return;
  }

  if (clickSound) {
    clickSound.currentTime = 0;
    clickSound.play().catch(() => {});
  }
});


</script>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    const allSounds = document.querySelectorAll("audio");
    const volumeSlider = document.querySelector(".slider .level");

    // Set initial volume from localStorage or default to 1
    const initialVolume = parseFloat(localStorage.getItem("marsVolume")) || 1;
    if (volumeSlider) volumeSlider.value = initialVolume;
    allSounds.forEach(sound => sound.volume = initialVolume);

    // Volume change handler
    if (volumeSlider) {
      volumeSlider.addEventListener("input", function () {
        const vol = parseFloat(this.value);
        allSounds.forEach(sound => sound.volume = vol);
        localStorage.setItem("marsVolume", vol);
      });
    }
const afterstory = document.getElementById("afterstorySound");
const mainsound= document.getElementById("mainsound");

if (afterstory) {
  afterstory.currentTime = 0;
  afterstory.loop = false; // play once
  afterstory.volume = initialVolume;

  afterstory.play().catch(err => console.warn("Afterstory play error:", err));

  setTimeout(() => {
    afterstory.pause();
    afterstory.currentTime = 0;mainsound

    if (mainsound) {
      mainsound.currentTime = 0;
      mainsound.loop = true;
      mainsound.volume = initialVolume;
      mainsound.play().catch(err => console.warn("gameboy play error:", err));
    }
  }, 7000); // Stop after 4 seconds
}

  });
</script>
<div id="sound-control" style="position: fixed; bottom: 20px; left: 25px; z-index: 9999; width: 25px;">
  <label class="slider">
    <input type="range" class="level" min="0" max="1" step="0.01" value="1" />
    <svg class="volume" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <g>
        <path d="M18.36 19.36a1 1 0 0 1-.705-1.71C19.167 16.148 20 14.142 20 12s-.833-4.148-2.345-5.65a1 1 0 1 1 1.41-1.419C20.958 6.812 22 9.322 22 12s-1.042 5.188-2.935 7.069a.997.997 0 0 1-.705.291z" fill="currentColor"></path>
        <path d="M15.53 16.53a.999.999 0 0 1-.703-1.711C15.572 14.082 16 13.054 16 12s-.428-2.082-1.173-2.819a1 1 0 1 1 1.406-1.422A6 6 0 0 1 18 12a6 6 0 0 1-1.767 4.241.996.996 0 0 1-.703.289zM12 22a1 1 0 0 1-.707-.293L6.586 17H4c-1.103 0-2-.897-2-2V9c0-1.103.897-2 2-2h2.586l4.707-4.707A.998.998 0 0 1 13 3v18a1 1 0 0 1-1 1z" fill="currentColor"></path>
      </g>
    </svg>
  </label>
</div>
</body>
</html>